{"ast":null,"code":"import React,{useEffect,useState}from'react';import API from'../../api';// your Axios instance\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UpdateApplication=_ref=>{let{jobId}=_ref;const[applications,setApplications]=useState([]);const[loading,setLoading]=useState(false);useEffect(()=>{const fetchApplications=async()=>{setLoading(true);try{const{data}=await API.get(`/jobs/${jobId}/applications`);setApplications(data.applications);}catch(error){console.error('Error fetching applications:',error);alert('Failed to fetch applications.');}setLoading(false);};if(jobId){fetchApplications();}},[jobId]);const updateStatus=async(applicationId,newStatus,applicantEmail,applicantName)=>{setLoading(true);try{// First, update the application status\nawait API.patch(`/jobs/update-status/${jobId}/${applicationId}`,{status:newStatus});// Send email for accepted, waiting, and rejected statuses\nawait API.post('/send-email',{to:applicantEmail,name:applicantName,jobId:jobId,status:newStatus// Pass status here\n});// Update local state\nsetApplications(prevApps=>prevApps.map(app=>app._id===applicationId?{...app,status:newStatus}:app));alert(`Application ${newStatus} successfully!`);}catch(error){console.error('Error updating status:',error);alert('Failed to update application status.');}setLoading(false);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Applications\"}),loading&&/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}),applications.length===0&&!loading&&/*#__PURE__*/_jsx(\"p\",{children:\"No applications found.\"}),applications.map(app=>{var _app$userId,_app$userId2;return/*#__PURE__*/_jsxs(\"div\",{style:{border:'1px solid gray',padding:'10px',marginBottom:'10px'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",(_app$userId=app.userId)===null||_app$userId===void 0?void 0:_app$userId.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",(_app$userId2=app.userId)===null||_app$userId2===void 0?void 0:_app$userId2.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Resume:\"}),\" \",' ',/*#__PURE__*/_jsx(\"a\",{href:`http://localhost:5000/${app.resume}`,target:\"_blank\",rel:\"noopener noreferrer\",children:\"View Resume\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Status:\"}),\" \",app.status]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{var _app$userId3,_app$userId4;return updateStatus(app._id,'waiting',(_app$userId3=app.userId)===null||_app$userId3===void 0?void 0:_app$userId3.email,(_app$userId4=app.userId)===null||_app$userId4===void 0?void 0:_app$userId4.name);},children:\"Waiting\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{var _app$userId5,_app$userId6;return updateStatus(app._id,'accepted',(_app$userId5=app.userId)===null||_app$userId5===void 0?void 0:_app$userId5.email,(_app$userId6=app.userId)===null||_app$userId6===void 0?void 0:_app$userId6.name);},children:\"Accept\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{var _app$userId7,_app$userId8;return updateStatus(app._id,'rejected',(_app$userId7=app.userId)===null||_app$userId7===void 0?void 0:_app$userId7.email,(_app$userId8=app.userId)===null||_app$userId8===void 0?void 0:_app$userId8.name);},children:\"Reject\"})]},app._id);})]});};export default UpdateApplication;","map":{"version":3,"names":["React","useEffect","useState","API","jsx","_jsx","jsxs","_jsxs","UpdateApplication","_ref","jobId","applications","setApplications","loading","setLoading","fetchApplications","data","get","error","console","alert","updateStatus","applicationId","newStatus","applicantEmail","applicantName","patch","status","post","to","name","prevApps","map","app","_id","children","length","_app$userId","_app$userId2","style","border","padding","marginBottom","userId","email","href","resume","target","rel","onClick","_app$userId3","_app$userId4","_app$userId5","_app$userId6","_app$userId7","_app$userId8"],"sources":["E:/mern-job-portal/mern-job-portal/mern-job-portal/frontend/src/components/HR/UpdateApplication.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport API from '../../api'; // your Axios instance\r\n\r\nconst UpdateApplication = ({ jobId }) => {\r\n    const [applications, setApplications] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const fetchApplications = async () => {\r\n            setLoading(true);\r\n            try {\r\n                const { data } = await API.get(`/jobs/${jobId}/applications`);\r\n                setApplications(data.applications);\r\n            } catch (error) {\r\n                console.error('Error fetching applications:', error);\r\n                alert('Failed to fetch applications.');\r\n            }\r\n            setLoading(false);\r\n        };\r\n\r\n        if (jobId) {\r\n            fetchApplications();\r\n        }\r\n    }, [jobId]);\r\n\r\n    const updateStatus = async (applicationId, newStatus, applicantEmail, applicantName) => {\r\n        setLoading(true);\r\n        try {\r\n            // First, update the application status\r\n            await API.patch(`/jobs/update-status/${jobId}/${applicationId}`, { status: newStatus });\r\n    \r\n            // Send email for accepted, waiting, and rejected statuses\r\n            await API.post('/send-email', {\r\n                to: applicantEmail,\r\n                name: applicantName,\r\n                jobId: jobId,\r\n                status: newStatus, // Pass status here\r\n            });\r\n    \r\n            // Update local state\r\n            setApplications(prevApps =>\r\n                prevApps.map(app =>\r\n                    app._id === applicationId ? { ...app, status: newStatus } : app\r\n                )\r\n            );\r\n    \r\n            alert(`Application ${newStatus} successfully!`);\r\n        } catch (error) {\r\n            console.error('Error updating status:', error);\r\n            alert('Failed to update application status.');\r\n        }\r\n        setLoading(false);\r\n    };\r\n    \r\n    return (\r\n        <div>\r\n            <h2>Applications</h2>\r\n            {loading && <p>Loading...</p>}\r\n            {applications.length === 0 && !loading && <p>No applications found.</p>}\r\n            {applications.map(app => (\r\n                <div key={app._id} style={{ border: '1px solid gray', padding: '10px', marginBottom: '10px' }}>\r\n                    <p><strong>Name:</strong> {app.userId?.name}</p>\r\n                    <p><strong>Email:</strong> {app.userId?.email}</p>\r\n                    <p>\r\n                        <strong>Resume:</strong> {' '}\r\n                        <a href={`http://localhost:5000/${app.resume}`} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                            View Resume\r\n                        </a>\r\n                    </p>\r\n                    <p><strong>Status:</strong> {app.status}</p>\r\n                    <button onClick={() => updateStatus(app._id, 'waiting', app.userId?.email, app.userId?.name)}>Waiting</button>\r\n                    <button onClick={() => updateStatus(app._id, 'accepted', app.userId?.email, app.userId?.name)}>Accept</button>\r\n                    <button onClick={() => updateStatus(app._id, 'rejected', app.userId?.email, app.userId?.name)}>Reject</button>\r\n                </div>\r\n            ))}\r\n        </div>\r\n    );\r\n    \r\n};\r\n\r\nexport default UpdateApplication;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}